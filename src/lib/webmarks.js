!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function s(t,e,i){if("complete"===document.readyState)setTimeout(()=>{t.apply(i,e)},0);else{const s=function(){document.removeEventListener("DOMContentLoaded",s),t.apply(i,e)};document.addEventListener("DOMContentLoaded",s)}}function n(t,e,i){for(let s=0,n=t.length;s<n;s++)e.call(i,s,t[s],t)}function o(t){return t instanceof Element}function r(t,e,i){let s,n;function o(){t.apply(i,n),s=n=void 0}return(...t)=>{t=t,s&&clearTimeout(s),s=setTimeout(o,e)}}i.r(e);let l={};function c(t){return t/l.height*window.innerHeight}function h(t){return function(t,e,i){const[s,n]=t,[o,r]=e;return(i-s)*(r-o)/(n-s)+o}([0,l.height],[0,window.innerHeight],t)}function a(t,e){let i=new Array(t.length);return n(t,void 0===e[0]?function(t,s){const n=s.getBoundingClientRect();let o=window.scrollY+n.top;e[t]={top:o,height:n.height},i[t]=d(o,n.height)}:function(t){const s=e[t];i[t]=d(s.top,s.height)}),i}function d(t,e){return{top:h(t),height:c(e)}}s(function(){l.height=function(){let t=document.body,e=document.documentElement;return Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight)}()}),i.d(e,"Webmarks",function(){return w});const p=()=>{},u=0!=window.scrollY,m=500,f={classes:{wrapper:["webmarks"],mark:["webmark"]},alwaysVisible:!1,hideAfter:500,renderSizes:!1,onNewMark:p,onUpdateMark:p,onCreation:p,onUpdate:p,beforeCreation:p,beforeUpdate:p,stickVisibilityTo:null,opacityTransition:100};class w{constructor(t,e){this._onScroll=this._onScroll.bind(this),this._onStickyScroll=this._onStickyScroll.bind(this),this._onStickyAlwaysShowScroll=this._onStickyAlwaysShowScroll.bind(this);try{s(this._init,[t,e],this)}catch(t){console.error(t)}}get visible(){return!!parseInt(this.wrapper.style.opacity)}set visible(t){this.wrapper.style.opacity=t>>>0}_init(t,e){this._setup(t,e),this._createMarks()}_setup(t,e){if(!t)throw new TypeError("Elements array can't be empty");let i=t[0];if(!o(i))throw new TypeError(JSON.stringify(i)+" (first element of the given elements) is not an HTMLElement");this.elems=t,this.cachedElemRects=new Array(t.length),this.opts={...f,...e},function(t,e){let i=document.createElement("style");if(document.getElementById(e))return null;e&&i.setAttribute("id",e),i.setAttribute("type","text/css"),i.innerText=t;const s=document.getElementsByTagName("link");if(0!==s.length){const t=s[0];document.head.insertBefore(i,t)}else document.head.appendChild(i)}(`.${this.opts.classes.wrapper}{`+"position:fixed;top:0;right:0;bottom:0;"+`transition: opacity ${this.opts.opacityTransition}ms;`+"}"+`.${this.opts.classes.mark}{`+"position:absolute;background:#333;right:0;}","webmarks--style"),this._createWrapper();const s=this.opts.stickVisibilityTo;this.opts.alwaysVisible?s&&(this.visible=!1,this._computeStickToBounding(s),this._onStickyAlwaysShowScroll(),document.addEventListener("scroll",()=>{window.requestAnimationFrame(this._onStickyAlwaysShowScroll)})):(this.visible=u,this.hideAfterScroll=r(this.hide,this.opts.hideAfter,this),s?(this._computeStickToBounding(s),document.addEventListener("scroll",()=>{window.requestAnimationFrame(this._onStickyScroll)})):document.addEventListener("scroll",()=>{window.requestAnimationFrame(this._onScroll)})),this.updateAfterResize=r(this._updateMarks,m,this),window.addEventListener("resize",()=>{window.requestAnimationFrame(this.updateAfterResize)})}show(){this.visible=!0}hide(){this.visible=!1}isOutside(){const t=window.scrollY;return t<this.stickTop||this.stickBottom<t}_createWrapper(){const t=this.wrapper=document.createElement("div");n(this.opts.classes.wrapper,(e,i)=>{t.classList.add(i)}),document.body.insertBefore(t,document.body.firstChild)}_createMarks(){const t=a(this.elems,this.cachedElemRects);this.marks=new Array(t.length),this.opts.beforeCreation(this.wrapper),n(t,(t,e)=>{const i=this.marks[t]=document.createElement("div");n(this.opts.classes.mark,(t,e)=>{i.classList.add(e)}),i.style.top=e.top+"px",this.opts.renderSizes&&(i.style.height=e.height+"px"),this.wrapper.appendChild(i),this.opts.onNewMark(i,this.wrapper)}),this.opts.onCreation(this.marks,this.wrapper)}_updateMarks(){const t=a(this.elems,this.cachedElemRects);this.opts.beforeUpdate(this.wrapper),n(t,(t,e)=>{const i=this.marks[t];i.style.top=e.top+"px",this.opts.onUpdateMark(i,this.wrapper)}),this.opts.onUpdate(this.marks,this.wrapper)}_computeStickToBounding(t){if(!o(t))throw new TypeError(JSON.stringify(t)+"(stickVisibilityTo) is not an HTMLElement");const e=t.getBoundingClientRect();this.stickTop=e.top+window.scrollY,this.stickBottom=this.stickTop+e.height}_onScroll(){this.visible?this.hideAfterScroll():this.show()}_onStickyScroll(){this.isOutside()&&!this.visible||(!this.isOutside()&&this.visible?this.hideAfterScroll():this.visible?this.hide():this.show())}_onStickyAlwaysShowScroll(){this.isOutside()&&!this.visible||!this.isOutside()&&this.visible||(this.isOutside()?this.hide():this.show())}}window.Webmarks=w}]);